---
source: ch5/src/lib.rs
expression: prog
---
extern read_int, print_int, print_str, print_bool, print_newline
section .rodata
    const_1 dq 1
            db `x`
    const_2 dq 1
            db `Y`
    const_3 dq 3
            db `abc`
    const_4 dq 3
            db `def`
section .text

    global _start
_start:
    push rbp
    mov rbp, rsp
    sub rsp, 8
    push rbx
    mov rbx, 1
    mov rcx, 2

block3:
    mov rdx, rcx
    neg rdx
    cmp rbx, rdx
    jl block6
    add rbx, 1
    cmp rbx, rcx
    je block1
    mov rbx, const_2

block0:
    mov rdi, rbx
    call print_str
    mov rdi, const_3
    call print_str
    mov rbx, 1
    xor rbx, 1
    mov rax, rbx
    call print_bool
    mov rdi, const_4
    call print_str
    call print_newline
    call read_int
    mov rbx, rax
    add rbx, 1
    sub rbx, 4
    mov rax, 17
    pop rbx
    call print_int
    call print_newline
    mov rsp, rbp
    pop rbp
    mov rax, 60
    mov rdi, 0
    syscall

block1:
    mov rbx, const_1
    jmp block0

block6:
    add rbx, rcx
    cmp rbx, 10
    jg block4
    mov rcx, rbx
    jmp block3

block4:
    mov rcx, rbx
    sub rcx, 1
    jmp block3

